<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .box {
            width: 600px;
            height: 300px;
            background: #ccc;
            position: absolute;
        }

        .el-card {
            width: 600px;
            height: 300px;
            background: #d42121;
            position: absolute;
            top: 0;
            left: 0;
        }
    </style>
</head>

<body>
    <div class="box">
        <div class="el-card">

        </div>
    </div>
    <script>
        // const box = document.querySelector('.box');

        // // ç»™å…ƒç´ ç»‘å®š mousedown äº‹ä»¶
        // box.addEventListener('mousedown', function (e) {
        //     // è®°å½•é¼ æ ‡åœ¨å…ƒç´ å†…çš„åç§»é‡
        //     const disX = e.clientX - box.offsetLeft;
        //     const disY = e.clientY - box.offsetTop;

        //     // ç»™ document ç»‘å®š mousemove äº‹ä»¶
        //     document.addEventListener('mousemove', moveBox);

        //     // ç»™ document ç»‘å®š mouseup äº‹ä»¶
        //     document.addEventListener('mouseup', function () {
        //         // å–æ¶ˆæ‹–æ‹½
        //         document.removeEventListener('mousemove', moveBox);
        //     });

        //     // å®šä¹‰æ‹–æ‹½å‡½æ•°
        //     function moveBox (e) {
        //         // è®¡ç®—å…ƒç´ çš„ä½ç½®
        //         const left = e.clientX - disX;
        //         const top = e.clientY - disY;

        //         // åˆ¤æ–­å…ƒç´ æ˜¯å¦è¶…å‡ºè§†å£
        //         const isLeftInViewport = left >= 0;
        //         const isTopInViewport = top >= 0;
        //         const isRightInViewport = left + box.offsetWidth <= window.innerWidth;
        //         const isBottomInViewport = top + box.offsetHeight <= window.innerHeight;

        //         // å¦‚æžœå…ƒç´ æ²¡æœ‰è¶…å‡ºè§†å£ï¼Œæ›´æ–°å…ƒç´ çš„ä½ç½®
        //         if (isLeftInViewport && isTopInViewport && isRightInViewport && isBottomInViewport) {
        //             box.style.left = left + 'px';
        //             box.style.top = top + 'px';
        //         }
        //     }
        // });
        
        const box = document.querySelector('.box');

        box.addEventListener('mousedown', (e) => {
            const ract = document.querySelector('.box')?.getBoundingClientRect();

            // åˆ¤æ–­ç›’å­å’Œè§†å£çš„è·ç¦»ï¼Œä¸èƒ½å°äºŽ0


            // åˆ¤æ–­é¼ æ ‡çš„ä½ç½®åœ¨ä¸åœ¨boxçš„ä¸­é—´éƒ¨åˆ†
            const disX = e.clientX - ract.left;
            const disY = e.clientY - ract.top;
            if (disX > 120 && disX < 550 && disY > 90 && disY < 170) {
                console.log('åœ¨ä¸­é—´');
                // ç§»é™¤ç‚¹å‡»äº‹ä»¶
                box.removeEventListener('mousedown', (e) => { });
                return;
            } else {
                console.log('ä¸åœ¨ä¸­é—´');
            }
            // é¼ æ ‡åˆ°å…ƒç´ è¾¹è·
            // console.log(disX, disY);

            const move = (e) => {
                const ract = document.querySelector('.box')?.getBoundingClientRect();
                // console.log(ract);
                // å…ƒç´ æ€Žä¹ˆåœ¨è§†å£å†…æ‹–æ‹½ç§»åŠ¨ï¼Œä½†æ˜¯ä¸èƒ½è¶…å‡ºè§†å£

                if(ract.left > 0 && ract.top > 0 && ract.right < window.innerWidth - 1 && ract.bottom < window.innerHeight - 1){
                    box.style.left = e.clientX - disX + 'px';
                    box.style.top = e.clientY - disY + 'px';
                }
                if(ract.left <= 0){
                    console.log(ract.left);
                    ract.left = 0
                    console.log(ract.left);
                    return ract.left += 13
                }
                if(ract.top <= 0){
                    ract.top = 0
                    console.log(ract.left);
                }
                if(ract.right >= window.innerWidth){
                    ract.right = window.innerWidth
                    console.log(ract.left);
                }
                if(ract.bottom >= window.innerHeight){
                    ract.bottom = window.innerHeight
                    console.log(ract.left);
                }
                // if (ract.left > 0 && ract.top > 0 && ract.right < window.innerWidth - 1 && ract.bottom < window.innerHeight - 1) {
                // } else {
                //     console.log('å†åŠ¨å°±å‡ºåŽ»äº†ðŸ¥µðŸ¥µðŸ¥µ');
                //     console.log(ract, disX, disY);
                //     box.style.left = e.clientX - disX + 'px';
                //     box.style.top = e.clientY - disY + 'px';
                    // box.style.left = e.clientX + disX + 'px';
                    // box.style.top = e.clientY + disX + 'px';
                    // if(ract.left <= 0) {
                    //     console.log(111);
                    //     box.style.left = disX + 'px';
                    // }
                    // if (ract.left >= 0 || ract.top >= 0 || ract.right <= window.innerWidth - 1 || ract.bottom <= window.innerHeight - 1) {
                    //     console.log(e.clientX , disX);
                    //     box.style.left = e.clientX  + 'px';
                    //     box.style.top = e.clientY  + 'px';
                    // }
                // }
            }
            box.addEventListener('mousemove', move);

            box.addEventListener('mouseup', (e) => {
                box.removeEventListener('mousemove', move);
            });
            box.addEventListener('mouseleave', (e) => {
                box.removeEventListener('mousemove', move);
            });
        }, false);

    </script>
</body>

</html>